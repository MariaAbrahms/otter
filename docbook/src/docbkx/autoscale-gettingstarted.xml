<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book [
<!-- Some useful entities borrowed from HTML -->
<!ENTITY ndash "&#x2013;">
<!ENTITY mdash "&#x2014;">
<!ENTITY hellip "&#x2026;">

<!-- Useful for describing APIs -->
<!ENTITY GET '<command xmlns="http://docbook.org/ns/docbook">GET</command>'>
<!ENTITY PUT '<command xmlns="http://docbook.org/ns/docbook">PUT</command>'>
<!ENTITY POST '<command xmlns="http://docbook.org/ns/docbook">POST</command>'>
<!ENTITY DELETE '<command xmlns="http://docbook.org/ns/docbook">DELETE</command>'>

<!ENTITY PRODNAME "Rackspace Auto Scale"> <!-- in PDF: for line 1 on the cover page -->
<!ENTITY PRODABBV "Rackspace Auto Scale"> <!-- in PDF: for page headers -->
<!ENTITY PROD "Auto Scale"> <!-- in body -->

<!-- changing authentication endpoints; define entities for US & UK rather than maintaining in text -->
<!ENTITY ENDPOINT-US "https://identity.api.rackspacecloud.com/v1.1/">
<!ENTITY ENDPOINT-UK "https://lon.identity.api.rackspacecloud.com/v1.1/">
<!ENTITY ENDPOINT-US-20 "https://identity.api.rackspacecloud.com/v2.0/">
<!ENTITY ENDPOINT-UK-20 "https://lon.identity.api.rackspacecloud.com/v2.0/">

<!ENTITY CHECK '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
<imageobject>
<imagedata fileref="img/Check_mark_23x20_02.svg"
format="SVG" scale="60"/>
</imageobject>
</inlinemediaobject>'>

<!ENTITY ARROW '<inlinemediaobject xmlns="http://docbook.org/ns/docbook">
<imageobject>
<imagedata fileref="img/Arrow_east.svg"
format="SVG" scale="60"/>
</imageobject>
</inlinemediaobject>'>

<!-- Useful for specs -->
<!ENTITY MAY '<emphasis xmlns="http://docbook.org/ns/docbook" role="strong">MAY</emphasis>'>
<!ENTITY SHOULD '<emphasis xmlns="http://docbook.org/ns/docbook" role="strong">SHOULD</emphasis>'>
<!ENTITY MUST '<emphasis xmlns="http://docbook.org/ns/docbook" role="strong">MUST</emphasis>'>
<!ENTITY MUST_NOT '<emphasis xmlns="http://docbook.org/ns/docbook" role="strong">MUST NOT</emphasis>'>
]>

<book version="5.0" xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:svg="http://www.w3.org/2000/svg"
    xmlns:m="http://www.w3.org/1998/Math/MathML"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xml:id="autoscale-getting-started"
    xmlns:raxm="http://docs.rackspace.com/api/metadata"
    xlink:href="http:// docs.autoscale.apiary.io/ ">
    <!-- The &PRODNAME; and &PRODABBV; are set in the entities at the top of this document -->
    <title>&PRODNAME; Getting Started Guide</title>
    <titleabbrev>&PRODABBV; Intro</titleabbrev>
    <?rax title.font.size="35px" subtitle.font.size="20px"
status.bar.text="Early Access"
canonical.url.base="http://docs.rackspace.com/autoscale/api/v1.0/cas-gettingstarted/content"?>
    <info>
        <releaseinfo>API v1.0</releaseinfo>
        <productname>&PRODNAME;</productname>
        <!-- enter the publication date of this document; in revhistory, explain what changed -->
        <pubdate>2013-11-01</pubdate>
        <copyright>
            <year>2013</year>
            <holder>Rackspace US, Inc.</holder>
        </copyright>
        <legalnotice role="rs-api">
            <annotation>
                <remark>Copyright details are filled in by the
                    template.</remark>
            </annotation>
        </legalnotice>
        <revhistory>
            <revision>
                <date>2013-10-31</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Added new content and images</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
            <revision>
                <date>2013-10-15</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Added new content on Deleting a
                                Scaling Group</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
            <revision>
                <date>2013-08-13</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Initial Early Access release.</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
            <revision>
                <date>2013-08-02</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Additional updates after
                                edit.</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
            <revision>
                <date>2013-07-22</date>
                <revdescription>
                    <itemizedlist spacing="compact">
                        <listitem>
                            <para>Initial internal draft for preview
                                release.</para>
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
        </revhistory>
        <raxm:metadata role="hidden">
            <raxm:displayname>Getting Started Guide</raxm:displayname>
            <raxm:product version="v1.0">cas</raxm:product>
            <raxm:priority>10</raxm:priority>
        </raxm:metadata>
    </info>
    <chapter xml:id="Overview">
        <title>Overview</title>
        <para>Rackspace Auto Scale is an API-based tool that
            automatically scales resources in response to an increase
            or decrease in overall workload based on user-defined
            thresholds. </para>
        <section xml:id="Doc_Change_History">
            <title>Document Change History</title>
            <para> This version of the document replaces and obsoletes
                all previous versions. The most recent changes are
                described in the following table: </para>
            <?rax revhistory?>
        </section>
        <!-- try again later
<xi:include href="./chapters/resources.xml"/>
-->
        <section xml:id="Resources"
            xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Additional Resources</title>
            <para> You can view and experiment with all &PRODNAME; API
                calls at <link
                    xlink:href="http://docs.autoscale.apiary.io/"
                    >http://docs.autoscale.apiary.io/</link>. </para>
            <para>To run the examples in this guide, the following
                prerequisites are required:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>Rackspace Cloud account. To sign up for
                            a Rackspace Cloud account, go to the
                            Rackspace Public Cloud <link
                                xlink:href="https://cart.rackspace.com/cloud/signup/"
                                >signup page</link>. </para>
                    </listitem>
                    <listitem>
                        <para>Rackspace username and password
                            specified during registration.</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>To use Rackspace Autoscale, you need to be able to
                complete the following tasks:</para>
            <itemizedlist>
                <listitem>
                    <para> Configure alarms by using Cloud Monitoring.
                        For more information, see the <link
                            xlink:href="http://docs.rackspace.com/cm/api/v1.0/cm-getting-started/content/index.html"
                            >Rackspace Cloud Monitoring Getting
                            Started Guide</link>. </para>
                </listitem>
                <listitem>
                    <para> Create servers by using Cloud Servers. For
                        more information, see the <link
                            xlink:href="http://docs.rackspace.com/servers/api/v2/cs-devguide/content/index.html"
                            >Next Generation Cloud Serversâ„¢ Developer
                            Guide</link>. </para>
                </listitem>
                <listitem>
                    <para> Create load balancers by using Cloud Load
                        Balancers. For more information see the <link
                            xlink:href="http://docs.rackspace.com/loadbalancers/api/v1.0/clb-devguide/content/index.html"
                            >Rackspace Cloud Load Balancers Developers
                            Guide</link>. </para>
                </listitem>
            </itemizedlist>
            <para>You can view detailed information about the
                Rackspace Autoscale API at <link
                    xlink:href="http:// docs.autoscale.apiary.io/ "
                    >http:// docs.autoscale.apiary.io/ </link>. Also,
                for a list of FAQs on Autoscale, read <link
                    xlink:href="https://one.rackspace.com/display/Stretch/Auto+Scale+FAQ+Doc+for+KC"
                    >the Auto Scale FAQ page on the Knowledge
                    Center</link>.</para>
        </section>
    </chapter>
    <chapter xml:id="Core_Concepts">
        <title>Core Concepts</title>
        <para>Rackspace &PROD; is an API-based tool that automatically
            scales resources in response to an increase or decrease in
            overall workload based on user-defined thresholds. </para>
        <para>&PROD; functions by linking these services: <itemizedlist>
                <listitem>
                    <para>Rackspace Cloud Monitoring. For more
                        information, read the Rackspace <link
                            xlink:href="http://docs.rackspace.com/cm/api/v1.0/cm-getting-started/content/Introduction.html"
                            >Cloud Monitoring Getting Started
                            Guide</link>.</para>
                </listitem>
                <listitem>
                    <para> &PROD; API </para>
                </listitem>
                <listitem>
                    <para> Load-balanced Cloud Servers. For more
                        information, read the Rackspace <link
                            xlink:href="http://docs.rackspace.com/loadbalancers/api/v1.0/clb-getting-started/content/DB_Doc_Change_History.html"
                            >Load Balancers Getting Started
                            Guide</link>.</para>
                </listitem>
            </itemizedlist>You can set up a schedule for launching
            Auto Scale or define an event that is triggered by Cloud
            Monitoring. You can also specify a minimum and maximum
            number of cloud servers, the amount of resources you want
            to increase or decrease and the thresholds in Cloud
            Monitoring that triggers the scaling activities.</para>
        <section xml:id="Basic_Workflow">
            <title>Auto Scale Process</title>
            <para> There are two ways to configure Auto Scale:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><link
                                linkend="Schedule_Based_Configuration"
                                >Scheduled-Based
                            Configuration</link></para>
                    </listitem>
                    <listitem>
                        <para><link
                                linkend="Monitoring_Based_Configuration"
                                >Monitoring-Based
                            Configuration</link></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>
                <note>
                    <para> &PROD; does not configure anything within a
                        server. You must configure your services to
                        function properly when each server is started.
                        We recommend automating your servers' startup
                        processes with <link
                            xlink:href="http://www.opscode.com/chef/"
                            >Chef</link> or a similar tool.</para>
                </note>
            </para>
            <section xml:id="Schedule_Based_Configuration">
                <title>Schedule-based Configuration</title>
                <para>You can configure Auto Scale to be triggered
                    based on a user-defined schedule that is specified
                    in one or more policies.</para>
                <para>This configuration option is helpful if you know
                    that your Cloud Server deployment will need
                    additional resources during certain peak times.
                    For example, if you need additional server
                    resources during the weekend, you can define a
                    policy that adds 50 servers on Friday evening and
                    then removes these servers again on Sunday evening
                    to return to a regular operational state.</para>
                <para>The following diagram outlines how Scaling by
                    Schedule works:</para>
                <informalfigure>
                    <mediaobject>
                        <imageobject>
                            <imagedata
                                fileref="images/ScalebySchedule.png"
                                contentwidth="6in"/>
                        </imageobject>
                    </mediaobject>
                </informalfigure>
                <para>
                    <note>
                        <para>The schedule-based configuration option
                            does not require Cloud Monitoring to be
                            set up.</para>
                    </note>
                </para>
            </section>
            <section xml:id="Monitoring_Based_Configuration">
                <title>Monitoring-based configuration</title>
                <para>You can configure Auto Scale to be triggered
                    based on a predefined alarm or threshold that has
                    been previously set up in Cloud Monitoring. </para>
                <para>Monitoring-based configuration works the
                    following way:</para>
                <para>
                    <orderedlist>
                        <listitem>
                            <para>In Cloud Monitoring, you configure
                                alarms that are triggered when a high
                                utilization of resources
                                occurs.</para>
                        </listitem>
                        <listitem>
                            <para>When Cloud Monitoring sets off an
                                alarm for high utilization of
                                resources within a group, a webhook is
                                triggered. </para>
                        </listitem>
                        <listitem>
                            <para>The webhook launches the Rackspace
                                Auto Scale service, which looks up the
                                policy that has been defined in
                                accordance with the webhook. This
                                policy determines the amount of cloud
                                servers that need to be added or
                                removed in case the alarm is
                                triggered. </para>
                        </listitem>
                    </orderedlist>
                </para>
            </section>
            <section xml:id="webhooks-anonymous-webhooks">
                <title>Webhooks, Anonymous Webhooks, and Capability
                    URLs</title>
                <para>Auto Scale uses webhooks to initiate a scaling
                    event. A webhook is an industry-standard protocol
                    for sending events between systems. A webhook
                    consists of HTTP callback that is triggered by
                    some user-defined event, such as an alarm that is
                    set through Cloud Monitoring. When that event
                    occurs the source site makes an HTTP request to
                    the URI configured for the webhook. </para>
                <para>A webhook contains a POST call to a defined URL,
                    potentially with a payload in the POST body.Â You
                    can send webhooks with a simple call in whatever
                    library is available for your environment.Â You can
                    also manually send them via cURL.Â  Â </para>
                <para>The following example shows how to send a
                    webhook with cURL:</para>
                <para>
                    <programlisting>curl -vÂ  http://example.com/webhook -X POST -d 'payload=payload'</programlisting>
                </para>
                <para>For more information about how webhooks are used
                    in the Rackspace API, see </para>
                <para><link
                        xlink:href="http://docs.rackspace.com/cm/api/v1.0/cm-devguide/content/service-notification-types-crud.html#service-notification-types-webhook"
                        >http://docs.rackspace.com/cm/api/v1.0/cm-devguide/content/service-notification-types-crud.html#service-notification-types-webhook</link>.</para>
                <para>Auto Scale also support anonymous webhooks. In
                    regular webhooks, the
                        <code>{capability_version}/{capability_hash}</code>
                    is specified by URL. In anonymous webhooks, the
                    URL is replaced with a hash that is known only to
                    the issuerâ€”this is the reason why the webhook is
                    called "anonymous" because no authentication is
                    needed. </para>
                <para> Capability URLs are URLs that give
                    authorization for a certain action or event. If
                    you know the URL, you have access to it and it
                    enables you to do something. Capability URLs are
                    usually long, random, and cannot be guessed by a
                    user.</para>
            </section>
            <section xml:id="cooldowns">
                <title>Cooldowns</title>
                <para>Auto Scale supports a cooldown feature. By
                    configuring cooldown periods between triggers, you
                    can control how quickly Auto Scale scales up
                    toward the scaling group's maximum size or down
                    toward the scaling group's minimum size. A
                    cooldown is a period during which no other scaling
                    activity occurs. </para>
                <para>Cooldowns work the following way:<itemizedlist>
                        <listitem>
                            <para>Cooldowns allow some time for the
                                initial scaling response to take
                                effect, potentially resolving the
                                situation that triggered the policy.
                                When a scaling policy is triggered,
                                cooldown periods begin for both the
                                scaling policy and the group. </para>
                        </listitem>
                        <listitem>
                            <para>While the cooldown is active, any
                                additional requests to the group or to
                                the specific policy are ignored.
                            </para>
                        </listitem>
                        <listitem>
                            <para>After the cooldown period ends, if
                                Cloud Monitoring still detects the
                                situation that triggered the initial
                                scaling activity, another alarm
                                triggers another round of scaling
                                activity. </para>
                        </listitem>
                    </itemizedlist></para>
            </section>
        </section>
    </chapter>
    <chapter xml:id="Autoscale_Components">
        <title>Autoscale Key Configurations</title>
        <para> &PROD; consists of the following configurations:
                <itemizedlist spacing="compact">
                <listitem>
                    <para>
                        <link linkend="Group_Configuration">Scaling
                            Group Configuration</link>
                    </para>
                </listitem>
                <listitem>
                    <para>
                        <link linkend="Launch_Configuration">Launch
                            Configuration </link></para>
                </listitem>
                <listitem>
                    <para>
                        <link linkend="Scaling_Policies">Scaling
                            Policies </link></para>
                </listitem>
            </itemizedlist></para>
        <section xml:id="Group_Configuration">
            <title>Scaling Group Configuration</title>
            <para>The scaling group configuration specifies the basic
                elements of the Auto Scale configuration. It manages
                how many servers can participate in the scaling group. </para>
            <table rules="all" width="566">
                <caption>GroupConfiguration Parameters</caption>
                <col width="175pt"/>
                <col width="69%"/>
                <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><parameter>name</parameter></td>
                        <td>Name of the scaling group</td>
                    </tr>
                    <tr>
                        <td><parameter>maxEntities</parameter></td>
                        <td>Specifies the maximum amount of identities
                            that are allowed in this group</td>
                    </tr>
                    <tr>
                        <td><parameter>minEntities</parameter></td>
                        <td>Specifies the minimum amount of identities
                            that are allowed in this group</td>
                    </tr>
                    <tr>
                        <td><parameter>cooldown</parameter></td>
                        <td>
                            <para>Describes, in seconds, how long the
                                group must wait after a scaling policy
                                is triggered before another request
                                for scaling is accepted. </para>
                        </td>
                    </tr>
                </tbody>
            </table>
            <para>The number of entities that are specified in
                minEntities and maxEntities overrides the amount of
                resources that can be specified in a policy. See also
                    <link linkend="Min_and_Max_Policies">Using the Min
                    and Max Values with Policies</link>.</para>
        </section>
        <section xml:id="Launch_Configuration">
            <title>Launch Configuration</title>
            <para>The launch configuration manages the process of
                creating new servers. It specifies what type of server
                image will be started on launch, what flavor the new
                server is, and which load balancer the new server
                connects to. </para>
            <para> The launch configuration specifies the following
                items: </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><emphasis role="bold"> Launch
                                Configuration Type</emphasis> -
                            specifies details about the launch
                            configuration</para>
                        <itemizedlist>
                            <listitem>
                                <para><parameter> type
                                   </parameter></para>
                                <para>Set to "launch_server" <?sbr?>
                                   <emphasis role="italic"> (For the
                                   Preview release, this is the only
                                   configuration type.) </emphasis>
                                </para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <emphasis role="bold">Server</emphasis> -
                            specifies details about the server</para>
                        <para>
                            <table>
                                <caption>server Parameters</caption>
                                <col width="175pt"/>
                                <col width="69%"/>
                                <thead>
                                   <tr>
                                   <td>Parameter Name</td>
                                   <td>Description</td>
                                   </tr>
                                </thead>
                                <tbody>
                                   <tr>
                                   <td><parameter>name</parameter></td>
                                   <td>Name of the scaling group</td>
                                   </tr>
                                   <tr>
                                   <td><parameter>flavorRef</parameter></td>
                                   <td>Specifies the maximum amount of
                                   identities that are allowed in this
                                   group</td>
                                   </tr>
                                   <tr>
                                   <td><parameter>imageRef</parameter></td>
                                   <td>Specifies the Id of the Cloud
                                   Server image to start.</td>
                                   </tr>
                                </tbody>
                            </table>
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            <emphasis role="bold">Load
                                Balancers</emphasis>- specifies
                            details about the load balancer </para>
                        <table>
                            <caption>loadBalancers
                                Parameters</caption>
                            <col width="175pt"/>
                            <col width="69%"/>
                            <thead>
                                <tr>
                                   <td>Parameter Name</td>
                                   <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                   <td><parameter>loadBalancerId</parameter></td>
                                   <td>Specifies the id of the load
                                   balancer that is automatically
                                   generated when the load balancer is
                                   created.</td>
                                </tr>
                                <tr>
                                   <td><parameter>port</parameter></td>
                                   <td>Specifies the port for the load
                                   balancer.</td>
                                </tr>
                            </tbody>
                        </table>
                    </listitem>
                </itemizedlist>
                <note>
                    <para>You can obtain details about your load
                        balancer(s) from the Control Panel or by using
                        the Load Balancer API. For more information,
                        see <link
                            xlink:href="http://docs.rackspace.com/loadbalancers/api/v1.0/clb-getting-started/content/List_LB_Details.html"
                            >List Load Balancer Details</link>.</para>
                </note>
            </para>
            <tip>
                <para> To learn more about configuring cloud servers
                    through an API, read the following: <itemizedlist>
                        <listitem>
                            <para>
                                <link
                                   xlink:href="http://docs.rackspace.com/servers/api/v2/cs-gettingstarted/content/overview.html"
                                   >Next Generation Cloud Servers
                                   Getting Started</link>
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <link
                                   xlink:href="http://docs.rackspace.com/servers/api/v2/cs-devguide/content/ch_api_operations.html"
                                   >Next Generation Cloud Servers
                                   Developer Guide</link>
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para> To learn more about configuring cloud load
                    balancers through an API, read the following: <itemizedlist>
                        <listitem>
                            <para>
                                <link
                                   xlink:href="http://docs.rackspace.com/loadbalancers/api/v1.0/clb-getting-started/content/DB_Overview.html"
                                   >Rackspace Cloud Load Balancers
                                   Getting Started</link>
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                <link
                                   xlink:href="http://docs.rackspace.com/loadbalancers/api/v1.0/clb-devguide/content/API_Operations-d1e1354.html"
                                   >Rackspace Cloud Load Balancers
                                   Developer Guide</link>
                            </para>
                        </listitem>
                    </itemizedlist></para>
            </tip>
        </section>
        <section xml:id="Scaling_Policies">
            <title>Scaling Group Policies</title>
            <para>Scaling group policies specify how to modify the
                scaling group and its behavior. You can specify
                multiple policies to manage a scaling group. </para>
            <para>Scaling policies specify the following:</para>
            <table>
                <caption>scalingPolicies Parameters</caption>
                <col width="175pt"/>
                <col width="69%"/>
                <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><parameter>name</parameter></td>
                        <td>Name of the scaling policy</td>
                    </tr>
                    <tr>
                        <td><parameter>changePercent</parameter></td>
                        <td>Specifies the change value, in incremental
                            stages or per cent.</td>
                    </tr>
                    <tr>
                        <td><parameter>cooldown</parameter></td>
                        <td>Specifies the policy cooldown time, in
                            seconds.</td>
                    </tr>
                    <tr>
                        <td><parameter>type</parameter></td>
                        <td>Specifies how the policy will be executed
                            (by webhook)</td>
                    </tr>
                </tbody>
            </table>
            <para>You have several options for defining an Auto Scale
                policy:</para>
            <itemizedlist spacing="compact">
                <listitem>
                    <para> Define a policy that triggers Auto Scale
                        activities <link
                            linkend="Schedule_Based_Configuration"
                            >based on a schedule</link>.</para>
                </listitem>
                <listitem>
                    <para>Define a policy that triggers Auto Scale
                        activities based on a predefined event.</para>
                </listitem>
                <listitem>
                    <para>Define a policy that scales up or down by a
                        predefined number of servers.</para>
                </listitem>
                <listitem>
                    <para>Define a policy that <link
                            linkend="Scale_by_percentage">scales up or
                            down by a predefined
                        percentage</link>.</para>
                </listitem>
            </itemizedlist>
            <section xml:id="Scale_by_percentage">
                <title>Scaling by Percentage</title>
                <para>You can define a policy that scales your server
                    resources up and down by a predefined percentage.
                    For example, you can define a policy to increase
                    your resources by 20% if a certain event
                    predefined event occurs. </para>
                <para>The following diagram outlines how scaling by
                    percentage works.</para>
                <informalfigure>
                    <mediaobject>
                        <imageobject>
                            <imagedata
                                fileref="images/ScalebyPercentage.png"
                                contentwidth="6in"/>
                        </imageobject>
                    </mediaobject>
                </informalfigure>
            </section>
            <section xml:id="Min_and_Max_Policies">
                <title>Using the Min and Max Values with
                    Policies</title>
                <para>When setting up the configuration for your
                    scaling groups, you specified the minimum and
                    maximum amount of resources that are allowed in
                    your configuration. These values are specified in
                    the minEntities and maxEntities parameters under
                    GroupConfiguration, and are invoked whenever your
                    group configuration is updated. If the amount of
                    resources that is specified in a policy differs
                    from the amount that is specified under
                    GroupConfiguration, the preconfigured values take
                    precedence. </para>
                <para>The following diagram illustrates how this
                    concept works.</para>
                <informalfigure>
                    <mediaobject>
                        <imageobject>
                            <imagedata fileref="images/Minandmax.png"
                                contentwidth="6in"/>
                        </imageobject>
                    </mediaobject>
                </informalfigure>
            </section>
            <section xml:id="Deleting_resources">
                <title>Deleting Resources<?sbr?></title>
                <para>You can set a policy to specify when you want
                    some of your resources deleted, and how many
                    resources should be deleted. </para>
                <para>When deleting servers, Auto Scale follows these
                    rules:</para>
                <para>
                    <itemizedlist>
                        <listitem>
                            <para>If there are no new servers that are
                                in the process of being built, the
                                oldest servers are deleted
                                first.</para>
                        </listitem>
                        <listitem>
                            <para>If there are new servers that are in
                                the process of being built and in a
                                "pending" state, these servers are
                                deleted first.</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>The following diagram illustrates how the
                    deletion process works.</para>
                <informalfigure>
                    <mediaobject>
                        <imageobject>
                            <imagedata
                                fileref="images/DeletePolicy.png"
                                contentwidth="6in"/>
                        </imageobject>
                    </mediaobject>
                </informalfigure>
            </section>
        </section>
    </chapter>
    <chapter xml:id="Autoscale_API">
        <title>Using the &PROD; API</title>
        <para>You can create a autoscaling group by following the
            steps described in this chapter. </para>
        <para>There are several options for sending requests through
            an API: </para>
        <itemizedlist>
            <listitem>
                <para>Developers and testers can use cURL, the
                    command-line tool from <link
                        xlink:href="http://curl.haxx.se/"
                        >http://curl.haxx.se/</link>. With cURL you
                    can send HTTP requests and receive responses from
                    the command line. </para>
            </listitem>
            <listitem>
                <para>If you prefer a more graphical interface, the
                    ReST client for Firefox also works for testing API
                    calls. For more information, see <link
                        xlink:href="https://addons.mozilla.org/en-US/firefox/addon/restclient/"
                        >https://addons.mozilla.org/en-US/firefox/addon/restclient/</link>.
                </para>
            </listitem>
            <listitem>
                <para>You can also download and install rest-client
                    from <link
                        xlink:href="http://code.google.com/p/rest-client/"
                        >http://code.google.com/p/rest-client/</link>.
                    Test-client is a Java application that lets you
                    test ReSTful web services. </para>
            </listitem>
        </itemizedlist>
        <para>
            <tip>
                <para> If you want to try these steps in your own
                    environment, you can use <link
                        xlink:href="http://docs.autoscale.apiary.io/"
                        >http://docs.autoscale.apiary.io/</link> to
                    generate cURL commands. </para>
            </tip>
        </para>
        <section xml:id="Authenticate">
            <title>Authenticate</title>
            <para>As with all Rackspace APIs, before you can use the
                Auto Scale API you must authenticate with your
                Rackspace credentials. </para>
            <itemizedlist>
                <listitem>
                    <para> When you authenticate, you submit your
                        credentials to the Rackspace Cloud Identity
                        Service.</para>
                </listitem>
                <listitem>
                    <para> If your credentials are valid, the Identity
                        Service responds with your Service Catalog,
                        which includes your token, token ID, user ID,
                        and token tenant ID. </para>
                </listitem>
                <listitem>
                    <para>To make requests of &PROD;, you must use
                        your token tenant ID, also known as the
                        tenantID. </para>
                </listitem>
            </itemizedlist>
            <para> If you subscribe to many Rackspace services, your
                Service Catalog response might be lengthy. For an
                example of an annotated Service Catalog response,
                showing how to recognize the token and other elements
                in both JSON and XML formats, see <link
                    xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/Sample_Request_Response-d1e64.html"
                    >http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/Sample_Request_Response-d1e64.html</link>. </para>
            <para> After you have your token, you can use it to
                identify yourself to &PRODNAME; and other services. </para>
            <tip>
                <para> For detailed information about the Rackspace
                    Cloud Identity Service, visit <link
                        xlink:href="http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/QuickStart-000.html"
                        >http://docs.rackspace.com/auth/api/v2.0/auth-client-devguide/content/QuickStart-000.html</link>.</para>
            </tip>
            <para>To authenticate access to Rackspace Cloud services,
                you issue an authentication request to the Rackspace
                Cloud Identity Service, which is an implementation of
                the OpenStack Keystone Identity Service v2.0. </para>
            <para>Auto Scale supports Role-based Access Control (RBAC)
                for more information, read <link
                    xlink:href="http://ord.admin.kc.rakr.net/knowledge_center/article/permissions-matrix-for-auto-scale"
                    >this article</link> on the Knowledge
                Center.</para>
            <important>
                <para>Multiple Rackspace Cloud Identity Service
                    endpoints exist. You may use any endpoint,
                    regardless of where your account was created.
                </para>
            </important>
            <para>The following table shows a list of valid
                endpoints:</para>
            <table rules="all">
                <caption>Regionalized Service Endpoints</caption>
                <thead>
                    <tr align="center">
                        <td colspan="2">Region</td>
                        <td colspan="5">Endpoint</td>
                    </tr>
                </thead>
                <tbody>
                    <tr align="left">
                        <td colspan="2">US</td>
                        <td colspan="5"
                                ><code>https://ord.autoscale.api.rackspacecloud.com/v1.0/</code><parameter>1234</parameter>/
                        </td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">UK</td>
                        <td colspan="5"
                                ><code>https://dfw.autoscale.api.rackspacecloud.com/v1.0/</code><parameter>1234</parameter>/
                        </td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">London (LON)</td>
                        <td colspan="5">
                            <code>https://lon.autoscale.api.rackspacecloud.com/v1.0/</code><parameter>1234</parameter>/
                        </td>
                    </tr>
                    <tr align="left">
                        <td colspan="2">Sydney (SYD)</td>
                        <td colspan="5">
                            <code>https://syd.autoscale.api.rackspacecloud.com/v1.0/</code><parameter>1234</parameter>/
                        </td>
                    </tr>
                </tbody>
            </table>
            <section xml:id="Authenticate_using_cURL">
                <title>Authenticate using cURL</title>
                <para>To authenticate against the Rackspace Auto Scale
                    API, you issue a POST request to the appropriate
                    Rackspace Cloud Identity Service endpoint. In the
                    request body, supply one of the following sets of
                    credentials:</para>
                <para>
                    <itemizedlist>
                        <listitem>
                            <para>user name and password</para>
                        </listitem>
                        <listitem>
                            <para>user name and API key</para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>You need to use your username and password to
                    log into the Rackspace Cloud Control Panel.</para>
                <para>To obtain your API key, log into <link
                        xlink:href="http://mycloud.rackspace.com."
                        >http://mycloud.rackspace.com</link>, click
                    your username, and select <emphasis role="bold"
                        >API Keys</emphasis> to get your key.</para>
                <para>
                    <example>
                        <title>Authenticate with Username and API Key:
                            JSON Request</title>
                        <programlisting>$ curl -s https://identity.api.rackspacecloud.com/v2.0/tokens -X 'POST' \
       -d '{"auth":{"RAX-KSKEY:apiKeyCredentials":{"username":"theUserName","apiKey":"0000000000000000000"}}}' \
       -H "Content-Type: application/json" | python -m json.tool </programlisting>
                    </example>
                </para>
            </section>
        </section>
        <section xml:id="Save_Image">
            <title>Save an Image</title>
            <para>After authenticating to the Web service you create a
                cloud server using one of the following
                methods:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para> Create a server through the <link
                                xlink:href="http://mycloud.rackspace.com/"
                                >Control Panel</link>. </para>
                    </listitem>
                    <listitem>
                        <para>Create a server through the Cloud
                            Servers API by using a <link
                                xlink:href="http://docs.rackspace.com/servers/api/v2/cs-devguide/content/CreateServers.html"
                                >Create Server</link> request. </para>
                    </listitem>
                </itemizedlist>
            </para>
            <para> With the Cloud Servers API, you can use a <link
                    xlink:href="http://docs.rackspace.com/servers/api/v2/cs-devguide/content/images-d1e4427.html"
                    >List Images</link> request to retrieve a list of
                options available for configuring your server. <example>
                    <title>Requesting a List of Cloud Server
                        Images</title>
                    <para>The following example shows how to request a
                        list cloud server images.</para>
                    <programlisting language="bash">$ curl -X GET \
        -H "Content-Type: application/json" \
        -H "X-Auth-token:{auth-token}" \
        https://ord.servers.api.rackspacecloud.com/v2/{tenant-id}/images?type=SNAPSHOT | python -mjson.tool
                    </programlisting>
                </example>
            </para>
            <para>After creating your server you customize it so that
                it can process your requests. For example, if you are
                building a webhead scaling group, configure Apache to
                start on launch and serve the files that you need. </para>
            <para> After you have created and customized your server,
                save its image and record the imageID value that is
                returned in the response body. </para>
        </section>
        <section xml:id="Create_Group">
            <title>Create and Manage a Scaling Group</title>
            <para>You can use the Autoscale API to create and manage
                your scaling group.</para>
            <example>
                <title>Creating a Scaling Group</title>
                <para>To create a scaling group, submit a
                        <command>POST</command> request with the
                        <parameter>tenantID</parameter> that you
                    obtained during the <link linkend="Authenticate"
                        >Authentication</link> step.The following
                    example shows how to create a scaling group. </para>
                <programlisting>POST https://autoscale.api.rackspacecloud.com/v1.0/{tenantID}/groups/
                </programlisting>
                <programlisting language="json"><xi:include href="./samples/reqCreateGroup.json" parse="text"/></programlisting>
                <para>The <command>POST</command> request creates a
                    scaling group, starts the minimum number of
                    servers, and attaches those servers to the
                    specified load balancer. </para>
                <para>If the <command>POST</command> request is
                    successful, the response data will be returned in
                    JSON format as shown in the following
                    example:</para>
                <programlisting language="json"><xi:include href="./samples/resCreateGroup.json" parse="text"/></programlisting>
            </example>
            <example>
                <title>List all Scaling Groups</title>
                <para>To obtain a list of all scaling groups, submit a
                        <command>GET</command> request with the
                        <parameter>tenantId</parameter> parameter
                    specified in the request URL.</para>
                <programlisting>GET /{tenantId}/groups
                </programlisting>
                <para>The following example shows a response for the
                        <command>GET</command> request with a list of
                    all scaling groups:</para>
                <programlisting language="json"><xi:include href="./samples/resGetGroups.json" parse="text"/></programlisting>
            </example>
            <example>
                <title>Manifested View of a Scaling Group
                    Configuration</title>
                <para>To obtain a detailed view of your scaling group
                    configuration, including the launch configuration,
                    and the scaling policies, submit a
                        <command>GET</command> request with the
                        <parameter>tenantId</parameter> and
                        <parameter>groupId</parameter> parameters
                    specified in the request URL.</para>
                <programlisting>GET /{tenantId}/groups/{groupId}</programlisting>
                <para>If the <command>GET</command> request is
                    successful, the data is returned in the body of
                    the response in JSON format as shown in the
                    following example</para>
                <programlisting language="json"><xi:include href="./samples/resGetGroupManifest.json" parse="text"/></programlisting>
            </example>
            <example>
                <title>Get the Current State of a Scaling
                    Group</title>
                <para>To obtain the current state of a scaling group,
                    including the current set of active entities, the
                    number of pending entities, and the desired number
                    of entities, submit a <command>GET</command>
                    request with the <parameter>tenantId</parameter>
                    and <parameter>groupId</parameter> parameters
                    specified in the request URL.</para>
                <programlisting>GET /{tenantId}/groups/{groupId}</programlisting>
                <para>If the <command>GET</command> request is
                    successful, the data is returned in the body of
                    the response in JSON format as shown in the
                    following example:</para>
                <programlisting language="json"><xi:include href="./samples/resGetGroupState.json" parse="text"/>
</programlisting>
            </example>
        </section>
    </chapter>
</book>
